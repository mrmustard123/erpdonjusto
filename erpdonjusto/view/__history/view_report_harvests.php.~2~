<?php

//error_reporting(E_ALL);
error_reporting(0);
session_start();

    // Al inicio de cada página
    if (isset($_SESSION['user_id'])) {
        $_SESSION['last_activity'] = time();
    }

    // Después puedes revisar cuánto tiempo ha pasado
    if (isset($_SESSION['last_activity']) && time() - $_SESSION['last_activity'] > 36000) {
        $elapsed=(time() - $_SESSION['last_activity']);
        echo 'La sesión ha expirado por inactividad: '.$elapsed.'<br/>';
        var_dump($_SESSION('last_activity'));

        if (isset($_SESSION['user_id'])) {
            // Regenerar ID de sesión periódicamente para mayor seguridad (opcional)
            if (!isset($_SESSION['last_regeneration']) || time() - $_SESSION['last_regeneration'] > 36000) {
                session_regenerate_id(true);
                $_SESSION['last_regeneration'] = time();
            }
        }else{
            session_regenerate_id(true);
        }
    }

$_SESSION['view']='radphp';

require_once("rpcl/rpcl.inc.php");
//Includes
use_unit("forms.inc.php");
use_unit("extctrls.inc.php");
use_unit("stdctrls.inc.php");
use_unit("dbtables.inc.php");
use_unit("db.inc.php");

//Class definition
class Unit1 extends Page
{
    public $Database1 = null;
    public $Datasource1 = null;
    public $Query1 = null;
}

global $application;

global $Unit1;

//Creates the form
$Unit1=new Unit1($application);

//Read from resource file
$Unit1->loadResource(__FILE__);

//Shows the form
$Unit1->show();

?>
